(this.webpackJsonpknitter=this.webpackJsonpknitter||[]).push([[0],{1548:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(40),s=n.n(a),i=(n(47),n(19)),o=n(5),u=n(4),l=n(1),j=Object(c.createContext)(void 0),d=function(e){var t=e.children,n=Object(c.useState)({title:"Knitter"}),r=Object(u.a)(n,2),a=r[0],s=r[1],i=Object(c.useCallback)((function(){s({title:"Knitter"})}),[s]);return Object(l.jsx)(j.Provider,{value:{header:a,setHeader:s,resetHeader:i},children:t})};function b(){var e=Object(c.useContext)(j);if(!e)throw new Error("StoreContext is undefinded");return e}var O=n(6),p=n(20),f=n(3),h=function(e){var t=e.label,n=e.placeholder,c=e.defaultValue,r=e.type,a=void 0===r?"text":r,s=e.name,i=e.autofocus,o=void 0!==i&&i,u=e.register,j=e.required,d=e.errors[s];return Object(l.jsxs)("div",{className:d?"input-group -invalid":"input-group",children:[Object(l.jsx)("label",{htmlFor:s,children:t}),Object(l.jsx)("input",Object(f.a)(Object(f.a)({},u(s,{required:j})),{},{type:a,autoFocus:o,name:s,defaultValue:c,id:s,className:"input",placeholder:n}))]})},m=function(e){var t=e.children,n=e.title,c=e.close,r=e.save;return Object(l.jsxs)("div",{className:"modal",children:[Object(l.jsx)("div",{className:"modal__background"}),Object(l.jsxs)("div",{className:"modal__body",children:[Object(l.jsxs)("header",{children:[Object(l.jsx)("h2",{children:n}),Object(l.jsx)("button",{onClick:c,type:"button",className:"btn btn-icon",children:Object(l.jsx)("span",{className:"material-icons-round",children:"close"})})]}),Object(l.jsx)("section",{children:t}),Object(l.jsxs)("footer",{children:[Object(l.jsx)("button",{onClick:c,type:"button",className:"btn btn-secondary",children:"Cancel"}),Object(l.jsx)("button",{onClick:r,type:"button",className:"btn btn-primary",children:"Save"})]})]})]})},x=function(e){var t=e.close,n=e.save,c=Object(p.a)(),r=c.register,a=c.handleSubmit,s=c.formState.errors;return Object(l.jsx)(m,{title:"Add part",close:t,save:a((function(e){return n(e)})),children:Object(l.jsxs)("div",{className:"add-part",children:[Object(l.jsx)(h,{label:"Name",name:"name",placeholder:"Ex. Right sleeve",autofocus:!0,required:!0,register:r,errors:s}),Object(l.jsx)(h,{type:"number",placeholder:"Ex. 0",defaultValue:0,label:"Count",name:"count",required:!0,register:r,errors:s})]})})};var v=function(e){var t=e.menuItems,n=Object(c.useState)(!1),r=Object(u.a)(n,2),a=r[0],s=r[1];return Object(l.jsxs)("div",{className:a?"menu-button -open":"menu-button",children:[Object(l.jsx)("button",{onClick:function(){return s(!a)},className:"menu-button__main",children:Object(l.jsx)("span",{className:"material-icons-round",children:a?"close":"menu"})}),Object(l.jsx)("div",{className:"menu-button__menu",children:t.map((function(e,t){return Object(l.jsx)("button",{onClick:function(){e.callback(),s(!1)},className:"btn menu-button__action",children:Object(l.jsx)("span",{className:"material-icons-round",children:e.icon})},t)}))})]})};var N=function(e){var t=e.part,n=e.deleteState,r=e.increasePart,a=e.decreasePart,s=e.setProjectCount,i=e.selectPart,o=Object(c.useState)(!1),j=Object(u.a)(o,2),d=j[0],b=j[1];return Object(l.jsxs)("li",{className:d?"project-details-list-item -open":"project-details-list-item",children:[Object(l.jsxs)("div",{onClick:function(){return b(!d)},className:"project-details-list-item__main",children:[n&&Object(l.jsx)("input",{className:"project-details-list-item__select",onClick:function(e){e.stopPropagation(),i(t.id)},type:"checkbox"}),Object(l.jsxs)("div",{className:"project-details-list-item__info",children:[Object(l.jsx)("p",{className:"title",children:t.name}),Object(l.jsxs)("p",{className:"count",children:["Count: ",t.count]})]}),Object(l.jsx)("button",{className:"btn arrow",onClick:function(){return b(!d)},children:Object(l.jsx)("span",{className:"material-icons-round",children:"expand_more"})})]}),Object(l.jsxs)("div",{className:"project-details-list-item__extra",children:[Object(l.jsx)("button",{onClick:function(){return a(t.id)},className:"project-details-list-item__min",children:Object(l.jsx)("span",{className:"material-icons-round",children:"remove"})}),Object(l.jsx)("input",{value:(+t.count).toString(),onChange:function(e){var n;return s(t.id,+(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value))},className:"project-details-list-item__counter",type:"number"}),Object(l.jsx)("button",{onClick:function(){return r(t.id)},className:"project-details-list-item__plus",children:Object(l.jsx)("span",{className:"material-icons-round",children:"add"})})]})]})},k=n(2),P=n.n(k),g=n(8),C=n(41),_=n(15),y=n(16),S=n(24),w=function(){function e(){Object(_.a)(this,e),this.projects=[]}return Object(y.a)(e,[{key:"getProjects",value:function(){return Promise.resolve(JSON.parse(localStorage.getItem("projects")||"[]"))}},{key:"getProjectById",value:function(e){var t=JSON.parse(localStorage.getItem("projects")||"[]").find((function(t){return t.id===e}));return t?Promise.resolve(Object(f.a)(Object(f.a)({},t),{},{parts:null===t||void 0===t?void 0:t.parts.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{count:+e.count})}))})):Promise.reject()}},{key:"createProject",value:function(e){return this.getProjects().then((function(t){return localStorage.setItem("projects",JSON.stringify([].concat(Object(O.a)(t),[Object(f.a)(Object(f.a)({},e),{},{id:S.datatype.uuid(),parts:[],finished:!1})])))}))}},{key:"createProjectPart",value:function(e,t){return this.getProjects().then((function(n){var c=Object(f.a)(Object(f.a)({},t),{},{id:S.datatype.uuid()}),r=n.map((function(t){return t.id===e?Object(f.a)(Object(f.a)({},t),{},{parts:[].concat(Object(O.a)(t.parts),[c])}):t}));return localStorage.setItem("projects",JSON.stringify(r))}))}},{key:"deleteProjectParts",value:function(e,t){return this.getProjects().then((function(n){var c=n.map((function(n){return n.id===e?Object(f.a)(Object(f.a)({},n),{},{parts:n.parts.filter((function(e){return!t.includes(e.id)}))}):n}));return localStorage.setItem("projects",JSON.stringify(c))}))}},{key:"syncProject",value:function(e){return this.getProjects().then((function(t){var n=t.map((function(t){return t.id===e.id?e:t}));return localStorage.setItem("projects",JSON.stringify(n))}))}}]),e}(),I=Object(c.createContext)(void 0),E=function(e){var t=e.children,n=Object(c.useMemo)((function(){return new w}),[]);return Object(l.jsx)(I.Provider,{value:n,children:t})};function J(){var e=Object(c.useContext)(I);if(!e)throw new Error("projectServiceContext is undefined");return e}var q=function(){var e=Object(c.useState)(),t=Object(u.a)(e,2),n=t[0],a=t[1],s=Object(C.useDebounce)(n,300),i=Object(u.a)(s,1)[0],o=J(),l=r.a.useCallback(function(){var e=Object(g.a)(P.a.mark((function e(t){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getProjectById(t).then((function(e){return a(e),e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o]),j=r.a.useCallback(function(){var e=Object(g.a)(P.a.mark((function e(t,n){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.createProjectPart(t,n).then((function(){return l(t)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[o,l]),d=r.a.useCallback(function(){var e=Object(g.a)(P.a.mark((function e(t,n){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.deleteProjectParts(t,n).then((function(){return l(t)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[o,l]),b=r.a.useCallback((function(e){n&&a(Object(f.a)(Object(f.a)({},n),{},{parts:n.parts.map((function(t){return t.id===e?Object(f.a)(Object(f.a)({},t),{},{count:t.count+1}):t}))}))}),[n,a]),O=r.a.useCallback((function(e){n&&a(Object(f.a)(Object(f.a)({},n),{},{parts:n.parts.map((function(t){return t.id===e?Object(f.a)(Object(f.a)({},t),{},{count:t.count-1}):t}))}))}),[n,a]),p=r.a.useCallback((function(e,t){n&&a(Object(f.a)(Object(f.a)({},n),{},{parts:n.parts.map((function(n){return n.id===e?Object(f.a)(Object(f.a)({},n),{},{count:t}):n}))}))}),[n,a]),h=r.a.useCallback(function(){var e=Object(g.a)(P.a.mark((function e(t){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.syncProject(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o]);return Object(c.useEffect)((function(){i&&h(i)}),[h,i]),{project:n,setProject:a,increasePart:b,decreasePart:O,setProjectCount:p,getProjectById:l,addProjectPart:j,deleteProjectParts:d}},B=function(){var e=c.useState(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],a=c.useState(!1),s=Object(u.a)(a,2),i=s[0],j=s[1],d=c.useState([]),p=Object(u.a)(d,2),f=p[0],h=p[1],m=q(),k=m.project,P=m.getProjectById,g=m.increasePart,C=m.decreasePart,_=m.setProjectCount,y=m.addProjectPart,S=m.deleteProjectParts,w=b().setHeader,I=Object(o.f)().id;function E(e){var t=!!f.find((function(t){return t===e}));return h(t?Object(O.a)(f).filter((function(t){return t!==e})):[].concat(Object(O.a)(f),[e]))}return c.useEffect((function(){P(I).then((function(e){e&&w({title:e.title,back:{path:"/"}})}))}),[I,P,w]),Object(l.jsx)("div",{className:"project-details",children:k&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("ul",{className:"project-details__list",children:null===k||void 0===k?void 0:k.parts.map((function(e,t){return Object(l.jsx)(N,{deleteState:i,part:e,setProjectCount:_,decreasePart:C,increasePart:g,selectPart:E},e.id)}))}),n&&Object(l.jsx)(x,{save:function(e){y(null===k||void 0===k?void 0:k.id,e),r(!1)},close:function(){return r(!1)}}),Object(l.jsx)(v,{menuItems:[{icon:"add",callback:function(){return r(!0)}},{icon:"delete",callback:function(){return j(!0)}}]}),i&&Object(l.jsxs)("div",{className:"project-details__selected",children:[Object(l.jsxs)("strong",{children:[f.length," selected"]}),Object(l.jsx)("button",{onClick:function(){S(k.id,f).then((function(){j(!1),h([])}))},disabled:f.length<=0,className:"btn btn-danger",children:"Delete selected"}),Object(l.jsx)("button",{onClick:function(){j(!1),h([])},className:"btn",children:Object(l.jsx)("span",{className:"material-icons-round",children:"close"})})]})]})})},F=function(e){var t=e.onClick;return Object(l.jsx)("button",{type:"button",onClick:t,className:"add-button",children:Object(l.jsx)("span",{className:"material-icons-round",children:"add"})})},H=function(e){var t=e.close,n=e.save,c=Object(p.a)(),r=c.register,a=c.handleSubmit,s=c.formState.errors;return Object(l.jsx)(m,{title:"Create project",close:t,save:a((function(e){return n(e)})),children:Object(l.jsx)("div",{className:"add-project",children:Object(l.jsx)(h,{label:"Title",name:"title",autofocus:!0,required:!0,register:r,errors:s})})})},A=function(e){var t=e.projects;return Object(l.jsx)("ul",{className:"projects-list",children:t.map((function(e){return Object(l.jsx)("li",{className:e.finished?"projects-list__item -finished":"projects-list__item",children:Object(l.jsxs)(i.b,{to:"/projects/".concat(e.id),children:[Object(l.jsxs)("div",{className:"project-list__info",children:[Object(l.jsx)("p",{className:"title",children:e.title}),Object(l.jsxs)("p",{className:"status",children:["Status: ",e.finished?"finished":"active"]})]}),Object(l.jsx)("span",{className:"material-icons-round",children:"chevron_right"})]})},e.id)}))})},M=function(){var e=c.useState(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],a=c.useState([]),s=Object(u.a)(a,2),i=s[0],o=s[1],j=c.useState("all"),d=Object(u.a)(j,2),O=d[0],p=d[1],f=J(),h=b().resetHeader,m=c.useMemo((function(){return i.filter((function(e){switch(O){case"active":return!e.finished;case"finished":return e.finished;default:return e}}))}),[i,O]),x=c.useCallback(Object(g.a)(P.a.mark((function e(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getProjects().then(o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),[f]),v=c.useCallback(function(){var e=Object(g.a)(P.a.mark((function e(t){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.createProject(t).then(x);case 2:r(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[f,x]);return c.useEffect((function(){x(),h()}),[f,x,h]),Object(l.jsxs)("div",{className:"projects",children:[Object(l.jsxs)("header",{className:"projects__header",children:[Object(l.jsx)("h2",{children:"Projects"}),Object(l.jsxs)("select",{value:O,onChange:function(e){return p(e.target.value)},children:[Object(l.jsx)("option",{value:"all",children:"All"}),Object(l.jsx)("option",{value:"finished",children:"Finished"}),Object(l.jsx)("option",{value:"active",children:"Active"})]})]}),Object(l.jsx)(A,{projects:m}),Object(l.jsx)(F,{onClick:function(){return r(!0)}}),n&&Object(l.jsx)(H,{close:function(){return r(!1)},save:v})]})};var V=function(){var e=b().header;return Object(l.jsx)("div",{className:"app",children:Object(l.jsxs)(i.a,{children:[Object(l.jsxs)("nav",{children:[e.back?Object(l.jsx)(i.b,{className:"-back",to:e.back.path,children:Object(l.jsx)("span",{className:"material-icons-round",children:e.back.icon||"west"})}):Object(l.jsx)("div",{}),Object(l.jsx)("h1",{children:e.title}),e.action?Object(l.jsx)("button",{onClick:e.action.callback,className:"-action",children:Object(l.jsx)("span",{className:"material-icons-round",children:e.action.icon})}):Object(l.jsx)("div",{})]}),Object(l.jsx)("main",{children:Object(l.jsxs)(o.c,{children:[Object(l.jsx)(o.a,{path:"/",exact:!0,component:M}),Object(l.jsx)(o.a,{path:"/projects/:id",component:B})]})})]})})};s.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(d,{children:Object(l.jsx)(E,{children:Object(l.jsx)(V,{})})})}),document.getElementById("root"))},47:function(e,t,n){}},[[1548,1,2]]]);
//# sourceMappingURL=main.5a8a71e9.chunk.js.map